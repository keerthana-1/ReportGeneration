using System;
using System.Collections.Generic;
using System.Configuration;
using System.Data;
using System.Data.SqlClient;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

namespace WebApplicationActivity
{
    public partial class createvulnerability : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {

        }

        protected void Submit_Click(object sender, EventArgs e)
        {
            string strcon = ConfigurationManager.ConnectionStrings["con"].ConnectionString;
            SqlConnection con = new SqlConnection(strcon);
            SqlCommand cmd;
            cmd = new SqlCommand("create_vulnerability", con);
            cmd.CommandType = CommandType.StoredProcedure;

            cmd.Parameters.AddWithValue("@Name", Name.Text);
            cmd.Parameters.AddWithValue("@AppType", AppType.Text);
            cmd.Parameters.AddWithValue("@Severity", Severity.Text);
            cmd.Parameters.AddWithValue("@CWE_CVE_id", CWE.Text);
            cmd.Parameters.AddWithValue("@OWASP", OWASP.Text);
            System.Web.UI.HtmlControls.HtmlTextArea description = (System.Web.UI.HtmlControls.HtmlTextArea)(form1.FindControl("Description"));
            string desc = description.Value;
            cmd.Parameters.AddWithValue("@Description", desc);
            cmd.Parameters.AddWithValue("@Impact", Impact.Text);
            cmd.Parameters.AddWithValue("@Recommendation", Recommendation.Text);
            cmd.Parameters.AddWithValue("@Attributing_Factor", AtributtingFactor.Text);

            con.Open();
            int i = cmd.ExecuteNonQuery();
            con.Close();


            Name.Text = string.Empty;
            AppType.Text = string.Empty;
            Severity.Text = string.Empty;
            CWE.Text = string.Empty;
            OWASP.Text = string.Empty;
         
            Impact.Text = string.Empty;
            Recommendation.Text = string.Empty;
            AtributtingFactor.Text = string.Empty;
        }
    }
}